<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Ynchen Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Redis、Java、前端等技术文章">
<meta property="og:type" content="website">
<meta property="og:title" content="Ynchen Blog">
<meta property="og:url" content="https://sgahch.github.io/index.html">
<meta property="og:site_name" content="Ynchen Blog">
<meta property="og:description" content="Redis、Java、前端等技术文章">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Ynchen">
<meta property="article:tag" content="Hexo, Blog, Redis, Java">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Ynchen Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Ynchen Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">技术笔记与分享</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS 订阅"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="搜索"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://sgahch.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-redis八股" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/08/14/redis%E5%85%AB%E8%82%A1/" class="article-date">
  <time class="dt-published" datetime="2025-08-14T00:57:28.000Z" itemprop="datePublished">2025-08-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/08/14/redis%E5%85%AB%E8%82%A1/">Redis面试题</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Redis-基本数据类型及常见应用场景有哪些？"><a href="#Redis-基本数据类型及常见应用场景有哪些？" class="headerlink" title="Redis 基本数据类型及常见应用场景有哪些？"></a>Redis 基本数据类型及常见应用场景有哪些？</h3><ul>
<li><strong>string</strong>：缓存对象（JSON&#x2F;XML）、计数器（访问量、点赞数）、分布式锁（setnx）、验证码、Session。</li>
<li><strong>hash</strong>：传输对象的存储、存储用户信息（id、name、email）、购物车、配置表。</li>
<li><strong>list</strong>：消息队列（存放消息）、顺序存储。</li>
<li><strong>set</strong>：存储相同属性的数据（如标签，可去重）、共同好友、抽奖、随机推荐。</li>
<li><strong>zset</strong>：排行榜、定时任务（score &#x3D; 时间戳）、优先级队列。</li>
<li><strong>bitmap</strong>：存储大数据量、统计活跃用户、签到、二进制标记。</li>
<li><strong>stream</strong>：流式存储，如高可靠消息队列、日志采集。</li>
</ul>
<h4 id="缓存穿透、击穿、雪崩？"><a href="#缓存穿透、击穿、雪崩？" class="headerlink" title="缓存穿透、击穿、雪崩？"></a>缓存穿透、击穿、雪崩？</h4><ul>
<li><strong>缓存穿透</strong>：客户端大量请求数据库和缓存中都不存在的数据，导致频繁请求数据库。<br>解决方案：缓存 null 值到缓存、布隆过滤器过滤、接口参数校验。</li>
<li><strong>缓存击穿</strong>：某个热点 key 缓存刚好过期，瞬间有大量请求打到数据库。<br>解决方案：互斥锁、给 key 设置逻辑过期时间。</li>
<li><strong>缓存雪崩</strong>：大量 key 在同一时间同时失效，请求全部打到数据库，压垮系统。<br>解决方案：给 key 设置随机 TTL、缓存预热、保证系统高可用。</li>
</ul>
<h4 id="如何保证缓存与数据库一致性？"><a href="#如何保证缓存与数据库一致性？" class="headerlink" title="如何保证缓存与数据库一致性？"></a>如何保证缓存与数据库一致性？</h4><p>保证缓存和数据库完全一致性在高并发场景下几乎不可能，通常采取策略减少不一致的时间窗口，根据业务选择合适的缓存更新策略，常见做法包括：</p>
<ul>
<li><strong>先更新数据库再删除缓存</strong>：最常用策略，删除缓存后，下次请求会从数据库重新读取并写入缓存。为避免并发不一致，可采用延迟双删（先删缓存→更新数据库→等一段时间再删缓存）。</li>
<li><strong>消息队列异步更新缓存</strong>：通过 MQ 异步通知更新缓存，降低数据库压力。</li>
<li><strong>Canal + MQ 异步更新</strong>：通过数据库 binlog（Canal）监听数据变更，再推送消息给缓存服务。</li>
<li><strong>分布式锁保证强一致性</strong>：写操作加分布式锁（如 Redis、Zookeeper），确保同一时间只有一个线程修改数据库和缓存，缺点是性能低，无法高并发写。</li>
</ul>
<h4 id="常见缓存更新策略有哪些？"><a href="#常见缓存更新策略有哪些？" class="headerlink" title="常见缓存更新策略有哪些？"></a>常见缓存更新策略有哪些？</h4><table>
<thead>
<tr>
<th>策略</th>
<th>描述</th>
<th>适用场景</th>
<th>注意点</th>
</tr>
</thead>
<tbody><tr>
<td>读穿（Read Through）</td>
<td>读请求先从缓存读，读不到再访问数据库并写入缓存</td>
<td>读多写少</td>
<td>需保证缓存和数据库写入同步</td>
</tr>
<tr>
<td>写穿（Write Through）</td>
<td>写请求写缓存的同时，缓存自动更新数据库</td>
<td>写少读多</td>
<td>写延迟会影响性能</td>
</tr>
<tr>
<td>写回（Write Back &#x2F; Asynchronous Write）</td>
<td>写缓存不直接写数据库，由后台异步批量刷新数据库</td>
<td>写多读少</td>
<td>风险：缓存宕机可能丢数据，需持久化机制（如 MySQL redo log）</td>
</tr>
<tr>
<td>旁路缓存（Cache Aside）</td>
<td>应用直接操作数据库，缓存只作暂存</td>
<td>常用</td>
<td>写操作需要手动更新 &#x2F; 删除缓存</td>
</tr>
</tbody></table>
<p><strong>补充原理</strong>：类似 MySQL 的 Buffer Pool（先写到缓存 &#x2F; 内存，再异步刷盘）、操作系统 Page Cache。</p>
<h4 id="为什么要删除缓存而不是直接更新？"><a href="#为什么要删除缓存而不是直接更新？" class="headerlink" title="为什么要删除缓存而不是直接更新？"></a>为什么要删除缓存而不是直接更新？</h4><ul>
<li>删除缓存操作更简单，避免复杂的更新逻辑。</li>
<li>更新缓存可能带来并发写冲突（如线程 A 先写数据库但 B 先更新缓存，导致缓存数据不一致）。</li>
</ul>
<h4 id="删除缓存失败怎么办？"><a href="#删除缓存失败怎么办？" class="headerlink" title="删除缓存失败怎么办？"></a>删除缓存失败怎么办？</h4><p>采用延迟双删策略：先删除缓存→更新数据库→等一段时间再删除缓存一次。等待时间可参考数据库写入并更新缓存的耗时，保证并发情况下脏数据不会长期存在。</p>
<h4 id="读写分离的场景下还能保证一致性吗？"><a href="#读写分离的场景下还能保证一致性吗？" class="headerlink" title="读写分离的场景下还能保证一致性吗？"></a>读写分离的场景下还能保证一致性吗？</h4><p>读写分离存在小概率不一致（主库写入后同步到从库存在延迟，此时访问从库可能读到旧数据）。解决办法：</p>
<ul>
<li>强一致场景加分布式锁。</li>
<li>合理设置缓存过期时间。</li>
<li>部分关键数据读写走主库。</li>
</ul>
<p><strong>总结面试核心观点</strong>：缓存一致性很难完全保证，只能尽量减少脏数据存在时间。延迟双删适合读多写少场景（强一致但性能低，写多读少不适合）；分布式锁保证强一致性，但牺牲并发性能；消息队列 &#x2F; Canal+MQ 是异步策略，降低耦合，保证最终一致性。</p>
<h3 id="Redis-主从同步与持久化机制了解过吗？"><a href="#Redis-主从同步与持久化机制了解过吗？" class="headerlink" title="Redis 主从同步与持久化机制了解过吗？"></a>Redis 主从同步与持久化机制了解过吗？</h3><h4 id="主从同步（Replication）"><a href="#主从同步（Replication）" class="headerlink" title="主从同步（Replication）"></a>主从同步（Replication）</h4><ul>
<li><strong>全量同步</strong>：从节点第一次连接主节点或从节点落后过多时，主节点发送整个 RDB 文件给从节点，从节点加载到内存。</li>
<li><strong>增量同步</strong>：全量同步完成后，主节点将后续写操作以命令流方式同步给从节点。<br><strong>同步原理</strong>：主节点维护 “数据偏移量（offset）”，从节点确认接收到的命令，保证主从数据一致。</li>
</ul>
<p><strong>哨兵机制（Sentinel）</strong>：</p>
<ul>
<li>监控节点状态，发现主节点宕机。</li>
<li>进行故障转移（选择复制偏移量最大、优先级高的从节点升级为主节点）。</li>
<li>保证集群可用性和自动恢复。</li>
</ul>
<h4 id="持久化机制（Persistence）"><a href="#持久化机制（Persistence）" class="headerlink" title="持久化机制（Persistence）"></a>持久化机制（Persistence）</h4><ul>
<li><strong>RDB（快照）</strong>：定期生成内存快照保存到磁盘。优点是效率高、恢复快；缺点是最近几秒的数据可能丢失。</li>
<li><strong>AOF（Append Only File）</strong>：记录每条写命令到日志（类似 MySQL binlog）。优点是持久性强，可配置 fsync 策略保证数据安全；缺点是日志大时性能开销大。</li>
<li><strong>混合持久化</strong>：AOF 重写时，将当前内存数据以 RDB 写入 AOF 文件，再追加新命令，综合 RDB 快速恢复和 AOF 持久性的优点。</li>
</ul>
<h3 id="Redis-为什么快？"><a href="#Redis-为什么快？" class="headerlink" title="Redis 为什么快？"></a>Redis 为什么快？</h3><ul>
<li><strong>内存存储</strong>：所有数据保存在内存中，避免磁盘 I&#x2F;O 开销，访问速度快。</li>
<li><strong>单线程模型</strong>：避免多线程上下文切换和锁竞争的开销。</li>
<li><strong>I&#x2F;O 多路复用</strong>：单线程通过事件循环监听所有客户端 socket 的 I&#x2F;O 状态（可读、可写、异常），高效处理大量并发连接。</li>
<li><strong>高效数据结构</strong>：提供 String、Hash、List 等多种数据结构，支持快速查找、排序和聚合操作。</li>
<li><strong>原子性保证</strong>：单条命令天然原子，Lua 脚本可保证多条命令原子执行，无需锁。</li>
</ul>
<h3 id="讲讲I-O-多路复用模型（Reactor-模型）？"><a href="#讲讲I-O-多路复用模型（Reactor-模型）？" class="headerlink" title="讲讲I&#x2F;O 多路复用模型（Reactor 模型）？"></a>讲讲I&#x2F;O 多路复用模型（Reactor 模型）？</h3><p>Redis 单线程能处理上千甚至上万并发连接，关键是使用 I&#x2F;O 多路复用模型。<br><strong>原理</strong>：单线程通过一个事件循环，监听所有客户端 socket 的 I&#x2F;O 状态（可读、可写、异常）。当某个 socket 可读或可写时，事件循环通知线程处理该事件，而非每个连接占用一个线程。<br><strong>常用实现</strong>：select、poll、epoll（Linux）、kqueue（BSD&#x2F;macOS）。<br><strong>优势</strong>：单线程避免锁竞争，减少上下文切换；高效处理大量并发连接；与 Redis 的内存数据结构结合，保证操作快速完成。<br><strong>形象比喻</strong>：像一个人同时盯着很多电话，某个电话响了就去接，处理完再继续监听其他电话，而非每个电话派一个人接。</p>
<h3 id="Redis-实现登录机制怎么实现？"><a href="#Redis-实现登录机制怎么实现？" class="headerlink" title="Redis 实现登录机制怎么实现？"></a>Redis 实现登录机制怎么实现？</h3><ol>
<li><strong>思路</strong>：使用 Redis 管理 Session&#x2F;Token<ul>
<li><strong>用户登录</strong>：用户提交账号密码→后端验证数据库→验证成功生成 Token（UUID 或 JWT）→将 Token 和用户信息存入 Redis 并设置过期时间（TTL）。</li>
<li><strong>登录状态维护</strong>：每次请求带上 Token→后端在 Redis 中查 Token 是否存在→存在则用户已登录，不存在则登录过期 &#x2F; 未登录。</li>
<li><strong>退出登录</strong>：删除 Redis 中的 Token→用户请求再校验 Redis，找不到即登出成功。</li>
</ul>
</li>
<li><strong>Redis 数据设计</strong><ul>
<li>Key: <code>login:token:&#123;token&#125;</code></li>
<li>Value: 用户信息 JSON（如<code>&#123;&quot;userId&quot;:1001,&quot;username&quot;:&quot;ynchen&quot;&#125;</code>）</li>
<li>TTL: 根据业务需求设置（如 30 分钟或 1 天）。</li>
</ul>
</li>
</ol>
<h3 id="Redis-实现防抖和节流怎么做？"><a href="#Redis-实现防抖和节流怎么做？" class="headerlink" title="Redis 实现防抖和节流怎么做？"></a>Redis 实现防抖和节流怎么做？</h3><ul>
<li><strong>防抖</strong>：每次事件触发时，在 Redis 设置带过期时间的 key；若 key 已存在则忽略操作，仅最后一次触发事件后过期时间到才执行操作，避免短时间内重复执行。</li>
<li><strong>节流</strong>：利用 Redis 的计数器和 TTL，每次请求先自增计数；若计数超过限制则拒绝请求，否则执行操作；计数器过期后重置，保证固定时间内执行次数不超过阈值。</li>
</ul>
<p>Redis 的高并发性能和自动过期特性，使其适合做分布式防抖和节流。</p>
<h3 id="bigkey-和-hotkey-如何优化？"><a href="#bigkey-和-hotkey-如何优化？" class="headerlink" title="bigkey 和 hotkey 如何优化？"></a>bigkey 和 hotkey 如何优化？</h3><h4 id="1-概念"><a href="#1-概念" class="headerlink" title="1. 概念"></a>1. 概念</h4><ul>
<li><strong>Big Key（大键）</strong>：占用内存特别大的 key（如 Hash 包含几十万字段、List&#x2F;ZSet 元素过多），会导致操作耗时过长，阻塞 Redis 单线程，影响其他请求。</li>
<li><strong>Hot Key（热键）</strong>：被频繁访问或写入的 key，高并发访问时可能成为性能瓶颈，甚至引发雪崩。</li>
</ul>
<h4 id="2-优化策略"><a href="#2-优化策略" class="headerlink" title="2. 优化策略"></a>2. 优化策略</h4><ul>
<li><strong>Big Key 优化</strong><ul>
<li>拆分数据：将大 Hash、List、ZSet 拆分成多个小 key，降低单个操作耗时（如购物车 10 万商品→按用户 &#x2F; 分类拆分多个 Hash）。</li>
<li>使用分页或批量操作：对 List&#x2F;ZSet 用 LRANGE、ZREVRANGE 分页读取，避免一次性遍历大集合。</li>
<li>避免频繁操作大 key：大 key 的写操作最好异步或通过队列处理，减少阻塞。</li>
</ul>
</li>
<li><strong>Hot Key 优化</strong><ul>
<li>缓存分片 &#x2F; 热点拆分：将一个热点 key 拆成多个小 key，分散访问压力。</li>
<li>本地缓存 + Redis 二级缓存：热点数据先在应用内存缓存一部分，减少对 Redis 的频繁访问。</li>
<li>异步处理写操作：对热点写请求异步批量更新，降低瞬时压力。</li>
<li>限流 + 防止雪崩：设置 TTL + 随机过期，防止热点同时过期造成缓存雪崩。</li>
</ul>
</li>
</ul>
<h4 id="3-面试亮点"><a href="#3-面试亮点" class="headerlink" title="3. 面试亮点"></a>3. 面试亮点</h4><ul>
<li>Big Key 优化核心是减少单个 key 的操作耗时。</li>
<li>Hot Key 优化核心是分散访问压力、防止瞬时并发打满 Redis。</li>
<li>实际生产中，两者常结合 TTL、异步队列和本地缓存策略使用。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sgahch.github.io/2025/08/14/redis%E5%85%AB%E8%82%A1/" data-id="cmeapodpp00002oe0288452ox" data-title="Redis面试题" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%85%AB%E8%82%A1/" rel="tag">八股</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-hello-world" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/08/14/hello-world/" class="article-date">
  <time class="dt-published" datetime="2025-08-14T00:38:11.193Z" itemprop="datePublished">2025-08-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2025/08/14/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://sgahch.github.io/2025/08/14/hello-world/" data-id="cmeapodps00012oe0ehk644ve" data-title="Hello World" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%AB%E8%82%A1/" rel="tag">八股</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/%E5%85%AB%E8%82%A1/" style="font-size: 10px;">八股</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/08/">八月 2025</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/08/14/redis%E5%85%AB%E8%82%A1/">Redis面试题</a>
          </li>
        
          <li>
            <a href="/2025/08/14/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 Ynchen<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>